<?xml version="1.0"?>
<odoo>    

    <!-- TREE RECORD legal case -->
    <record id="axel_legal_case_view_tree" model="ir.ui.view">
        <field name="name">axel.legal_case.tree</field>
        <field name="model">axel.legal_case</field>
        <field name="arch" type="xml">
            <tree string="Legal case"
                decoration-success="status == 'paied'"
                decoration-info="status == 'pending'"
                decoration-muted="status == 'archived'"
            >
                <field name="name" />
                <field name="client_ref" />
                <field name="client_id" />
                <field name="open_date" />
                <field name="status" />
                <field name="total_unpaied" />
                <field name="currency_id" optional="hide" />
            </tree>
        </field>

    </record>

    <!-- Axel legal case Action -->
    <record id="axel_legal_case_action" model="ir.actions.act_window">
        <field name="name">Dossiers</field>
        <field name="res_model">axel.legal_case</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="axel_legal_case_view_tree"/>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">Define a new legal case</p>
        </field>
        <field name="context">{'search_default_available_status_legal_case': True}</field>
    </record>

    


    <!-- Customize the form view -->
    <record id="legal_case_view_form" model="ir.ui.view">
        <field name="name">axel.legal_case.form</field>
        <field name="model">axel.legal_case</field>
        <field name="arch" type="xml">
            <form string="Dossier">
                <header>
                    <button 
                        class="oe_highlight"
                        string="Payé"
                        type="object" name="mark_as_paid"
                        invisible="status != 'pending'" 
                    />
                    <button 
                        class="oe_highlight"
                        string="Revenir à non payé"
                        type="object" name="mark_as_pending"
                        invisible="status != 'paied'" 
                    />
                    <button 
                        string="Archivé"
                        type="object" name="mark_as_archived"
                        invisible="status == 'paied' or status == 'archived'" 
                    />
                    <field name="status" widget="statusbar" statusbar_visible="pending,paied,archived"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <div class="oe_edit_only">
                            <label for="name"/>
                        </div>
                        <h1 class="mb32">
                            <field name="name" class="mb16"/>
                        </h1>
                    </div>
                    <group>
                        <group>
                            <field name="client_ref"/>
                            <field name="open_date"/>
                            <field name="type"/>
                            <field name="court_type"/>
                        </group>
                        <group>
                            <field name="currency_id" invisible="1" />
                            <field name="court"/>
                            <field name="tribunal"/>
                            <!-- <field name="total_unpaied"/> -->
                        </group>
                        <group>
                            <field name="client_id" ></field>
                            <field name="pv_id" ></field>
                            <field name="parent_case_id" ></field>
                            <field name="status" />
                        </group>

                    </group>
                    <div class="o_kanban_content my-3">
                        <div class="row" >
                            <div class="col-md-3">
                                <div class="card text-white bg-primary mb-3" style="max-width: 18rem;">
                                    <div class="card-header">Total des dépences</div>
                                    <div class="card-body">
                                        <h5 class="card-title"><field name="total_expenses" /> </h5>
                                    </div>
                                </div>
                            
                            </div>
                            <div class="col-md-3">
                                <div class="card text-white bg-primary mb-3" style="max-width: 18rem;">
                                    <div class="card-header">Total des honoraires</div>
                                    <div class="card-body">
                                        <h5 class="card-title"><field name="total_charges" /> </h5>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card text-white bg-primary mb-3" style="max-width: 18rem;">
                                    <div class="card-header">Total des paiements</div>
                                    <div class="card-body">
                                        <h5 class="card-title"><field name="total_payments" /> </h5>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card text-white bg-primary mb-3" style="max-width: 18rem;">
                                    <div class="card-header">Total des impayés</div>
                                    <div class="card-body">
                                        <h5 class="card-title"><field name="total_unpaied" /></h5>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <notebook>
                        <page string="Dépences">
                            <group>
                                <field
                                    string="" style="margin-top: 10px;" name="expense_ids"
                                    readonly="status in ['paied', 'archived']" 
                                    context="{'default_type': 'expense'}"
                                >
                                    <tree string="Liste des dépences" editable="top">
                                        <field name="amount"/> 
                                        <field name="payment_date"/> 
                                        <field name="description" />  
                                        <field name="receipt_scanned"/>   
                                        <field name="is_paid"/> 
                                        <field name="type" column_invisible="True" />
                                        <field name="currency_id" optional="hide"  />
                                    </tree>
                                   
                                </field>
                            </group>
                        </page>
                        <page string="Honoraires">
                            <group>
                                <field
                                    string="" 
                                    style="margin-top: 10px;"
                                    name="charge_ids"
                                    readonly="status in ['paid', 'archived']"
                                    context="{'default_type': 'charge'}"
                                >
                                    <tree string="Liste des honoraires" editable="top" >
                                        <field name="amount"/> 
                                        <field name="payment_date"/> 
                                        <field name="description" /> 
                                        <field name="is_paid"/> 
                                        <field name="type" column_invisible="True" />
                                        <field name="currency_id" optional="hide"  />
                                    </tree>
                                   
                                </field>
                            </group>
                        </page>
                        <page string="Recettes">
                            <group>
                                <field
                                    string="" style="margin-top: 10px;" name="payment_ids"
                                    readonly="status in ['paid', 'archived']"
                                >
                                    <tree string="Liste des recettes" editable="top" >
                                        <field name="amount"/> 
                                        <field name="payment_date"/> 
                                        <field name="description" />    
                                        <field name="receipt_scanned"/> 
                                    </tree>
                                    <!-- <form string="Modifer dépence">
                                        <div>
                                            <group>
                                                <group>
                                                    <field name="amount"/> 
                                                </group>
                                                <group>
                                                    <field name="payment_date"/> 
                                                </group>
                                            </group>
                                            
                                            <group>
                                                <group>
                                                    <field name="receipt_scanned"/> 
                                                </group>
                                            </group>
                                        </div>
                                        <div>
                                            <group>
                                                <field name="description" />    
                                            </group>
                                        </div>
                                    </form> -->
                                </field>
                            </group>
                        </page>
                        
                        <page string="Documents">
                            <group>
                                <field
                                    string="" style="margin-top: 10px;" name="document_ids"
                                    readonly="status in ['paid', 'archived']"
                                >
                                    <tree string="Liste des recettes" editable="top" >
                                        <field name="name"/> 
                                        <field name="document_file"/> 
                                    </tree>
                                    <!-- <form string="Modifer dépence">
                                        <div>
                                            <group>
                                                <group>
                                                    <field name="name"/> 
                                                </group>
                                                <group>
                                                    <field name="document_file"/> 
                                                </group>
                                            </group>
                                        </div>
                                    </form> -->
                                </field>
                            </group>
                        </page>
                        <page string="Audience">
                            <group>
                                <field
                                    string="" style="margin-top: 10px;" name="trial_ids"
                                    readonly="status in ['paid', 'archived']"
                                >
                                    <tree string="Liste des audiences" >
                                        <field name="amount"/> 
                                        <field name="trial_date"/> 
                                    </tree>
                                    <form string="Modifer l'audience">
                                        <div>
                                            <group>
                                                <group>
                                                    <field name="amount"/> 
                                                </group>
                                                <group>
                                                    <field name="trial_date"/> 
                                                </group>
                                                <group>
                                                    <field name="type"/> 
                                                </group>
                                                <group>
                                                    <field name="court_type"/> 
                                                </group>
                                            </group>
                                            <group>
                                                <group>
                                                    <field name="case_number"/> 
                                                </group>
                                                <group>
                                                    <field name="observation"/> 
                                                </group>
                                                <group>
                                                    <field name="scanned_document"/> 
                                                </group>
                                            </group>
                                        </div>
                                    </form>
                                </field>
                            </group>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>
    <!-- Customize the form view -->

    <!-- Customize the search legalcase view -->
    <record id="legal_case_view_search" model="ir.ui.view">
        <field name="name">axel.legal_case.view.search</field>
        <field name="model">axel.legal_case</field>
        <field name="arch" type="xml">
            <search string="Rechercher un dossier">
                <field name="name" />
                <field name="client_ref" />
                <field name="open_date" />
                <field name="total_unpaied" string="Impayé" filter_domain="[('unpaid', '&gt;=', 0)]" />
                <field name="total_unpaied" string="Payé" filter_domain="[('unpaid', '=', 0)]" />
                <separator /> 
                <filter
                    name="available_status_legal_case"
                    string="Actif"
                    domain="[('status', '!=', 'archived')]"
                    help="Afficher uniquement les dossiers actif."
                />
                <filter
                    name="archived_status_legal_case"
                    string="Archivé"
                    domain="[('status', '=', 'archived')]"
                    help="Afficher uniquement les dossiers actif."
                />
                <filter
                    name="unpaid_legal_case"
                    string="Dossiers impayés"
                    domain="[('total_unpaied', '>', 0)]"
                    help="Afficher uniquement les dossiers non payés."
                />
                <filter
                    name="paid_available_status_legal_case"
                    string="Dossiers payés"
                    domain="[('total_unpaied', '=', 0)]"
                    help="Afficher uniquement les payés."
                />
            </search>
        </field>
    </record>


    <record id="action_report_axel_legal_case_detail" model="ir.actions.report">
        <field name="name">Imprimer dossier</field>
        <field name="model">axel.legal_case</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">axel.report_detail_client</field>
        <field name="report_file">axel.report_detail_client</field>
        <field name="print_report_name">(object._get_report_from_name())</field>

        <field name="binding_model_id" ref="model_axel_legal_case"/>
        <field name="binding_type">report</field>
    </record>
</odoo>
